<ng-container *ngIf="vm$ | async as vm">
  <ng-container *ngIf="vm.layout === 'table'; else emptyComponent">
    <div
      class="flex gap-2 justify-content-end align-content-center align-items-center"
      *ocxIfPermission="'SEARCHCONFIG#VIEW'; permissions: permissions"
    >
      <div class="flex gap-2 align-content-center align-items-center">
        <ng-container
          *ngIf="
            vm.currentConfig &&
            !vm.currentConfig.isReadonly &&
            hasOnlyColumns(vm.currentConfig) &&
            !vm.editMode
          "
        >
          <button
            *ocxIfPermission="'SEARCHCONFIG#EDIT'; permissions: permissions"
            pButton
            type="button"
            icon="{{ editIcon }}"
            [pTooltip]="'SEARCH_CONFIG.EDIT.TOOLTIP' | translate"
            tooltipPosition="top"
            tooltipEvent="hover"
            (click)="onSearchConfigEdit($event, vm.currentConfig)"
            [attr.aria-label]="'SEARCH_CONFIG.EDIT.ARIA_LABEL' | translate"
          ></button>
          <button
            *ocxIfPermission="'SEARCHCONFIG#DELETE'; permissions: permissions"
            icon="{{ deleteIcon }}"
            pButton
            type="button"
            [pTooltip]="'SEARCH_CONFIG.DELETE.TOOLTIP' | translate"
            tooltipPosition="top"
            tooltipEvent="hover"
            (click)="onSearchConfigDelete($event, vm.currentConfig)"
            [attr.aria-label]="'SEARCH_CONFIG.DELETE.ARIA_LABEL' | translate"
          ></button>
        </ng-container>
        <button
          *ngIf="vm.editMode && vm.isInChargeOfEdit"
          [label]="'SEARCH_CONFIG.SAVE_EDIT.LABEL' | translate"
          icon="{{ saveIcon }}"
          pButton
          type="button"
          [pTooltip]="'SEARCH_CONFIG.SAVE_EDIT.TOOLTIP' | translate"
          tooltipPosition="top"
          tooltipEvent="hover"
          (click)="onSearchConfigSaveEdit($event, vm.currentConfig)"
          [attr.aria-label]="'SEARCH_CONFIG.SAVE_EDIT.ARIA_LABEL' | translate"
        ></button>
        <button
          *ngIf="vm.editMode && vm.isInChargeOfEdit"
          [label]="'SEARCH_CONFIG.CANCEL_EDIT.LABEL' | translate"
          icon="{{ stopIcon }}"
          pButton
          type="button"
          [pTooltip]="'SEARCH_CONFIG.CANCEL_EDIT.TOOLTIP' | translate"
          tooltipPosition="top"
          tooltipEvent="hover"
          (click)="onSearchConfigCancelEdit()"
          [attr.aria-label]="'SEARCH_CONFIG.CANCEL_EDIT.ARIA_LABEL' | translate"
        ></button>
        <p-floatLabel>
          <p-dropdown
            inputId="columnGroupSelectionDropdown"
            (onClear)="clearGroupSelection()"
            (onChange)="changeGroupSelection($event)"
            [options]="vm.allGroupKeys"
            [placeholder]="placeholderKey | translate"
            [disabled]="vm.editMode"
            [showClear]="vm.selectedGroupKey !== defaultGroupKey"
            [(ngModel)]="vm.selectedGroupKey"
            appendTo="body"
            [ariaLabel]="
              'OCX_CUSTOM_GROUP_COLUMN_SELECTOR.DROPDOWN_ARIA_LABEL' | translate
            "
          >
            <ng-template let-item pTemplate="item">
              <div
                class="flex align-items-center gap-2 h-2rem justify-content-between"
              >
                <div *ngIf="!isSearchConfig(item, vm); else search_config_item">
                  {{ item ? (item | translate) : '' }}
                </div>
                <ng-template #search_config_item>
                  <div>
                    {{ item }}
                  </div>
                </ng-template>
              </div>
            </ng-template>
            <ng-template let-item pTemplate="selectedItem">
              <div
                class="flex align-items-center gap-2 justify-content-between"
              >
                <ng-container *ngIf="vm.editMode">
                  <div>
                    {{
                      'SEARCH_CONFIG.EDITING'
                        | translate: { config: vm.currentConfig?.name }
                    }}
                  </div>
                </ng-container>
                <ng-container *ngIf="!vm.editMode">
                  <div
                    *ngIf="
                      !isSearchConfig(item, vm);
                      else search_config_selected_item
                    "
                  >
                    {{ item ? (item | translate) : '' }}
                  </div>
                  <ng-template #search_config_selected_item>
                    <div>
                      {{ item }}
                    </div>
                  </ng-template>
                </ng-container>
              </div>
            </ng-template>
          </p-dropdown>
          <label
            *ngIf="vm.allGroupKeys.length"
            for="columnGroupSelectionDropdown"
          >
            {{ 'OCX_CUSTOM_GROUP_COLUMN_SELECTOR.DROPDOWN_LABEL' | translate }}
          </label>
        </p-floatLabel>
      </div>
    </div>
  </ng-container>
  <ng-template #emptyComponent> </ng-template>
</ng-container>
